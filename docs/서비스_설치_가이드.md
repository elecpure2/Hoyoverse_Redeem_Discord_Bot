# 🤖 호요봇 백그라운드 실행 가이드

## 📋 개요
이 가이드는 호요봇을 Windows에서 백그라운드로 실행하고, 컴퓨터 부팅 시 자동으로 시작하도록 설정하는 방법을 안내합니다.

## 🚀 빠른 시작

### 1단계: 서비스 설치 (최초 1회만)
1. **PowerShell을 관리자 권한으로 실행**
   - 시작 메뉴 → "PowerShell" 검색
   - 마우스 우클릭 → "관리자 권한으로 실행"

2. **설치 스크립트 실행**
   ```powershell
   cd "C:\Users\elecp\OneDrive\Desktop\Server\Hoyo Bot"
   .\install_service.ps1
   ```

3. **완료!** 이제 컴퓨터를 재부팅하면 자동으로 봇이 시작됩니다.

### 2단계: 봇 제어

#### 방법 1: 제어 패널 사용 (추천)
```powershell
.\control_bot.ps1
```
- 메뉴에서 원하는 작업 선택
- 봇 시작/중지/재시작
- 로그 실시간 확인

#### 방법 2: PowerShell 명령어
```powershell
# 봇 수동 시작
Start-ScheduledTask -TaskName "HoyoBot_AutoStart"

# 봇 중지
Stop-ScheduledTask -TaskName "HoyoBot_AutoStart"
taskkill /F /IM python.exe

# 작업 스케줄러에서 제거 (관리자 권한 필요)
.\uninstall_service.ps1
```

## 📄 로그 확인

### 실시간 로그 보기
```powershell
.\control_bot.ps1
# → 메뉴에서 "6. 로그 실시간 모니터링" 선택
```

### 로그 파일 직접 열기
- **일반 로그**: `bot.log`
- **에러 로그**: `bot_error.log`

## 🔧 트러블슈팅

### 봇이 시작되지 않는 경우
1. **작업 스케줄러 확인**
   ```powershell
   Get-ScheduledTask -TaskName "HoyoBot_AutoStart"
   ```

2. **로그 파일 확인**
   ```powershell
   Get-Content bot_error.log -Tail 50
   ```

3. **수동 실행 테스트**
   ```powershell
   .\run.ps1
   ```

### Python 프로세스가 여러 개 실행되는 경우
```powershell
# 모든 Python 프로세스 종료
taskkill /F /IM python.exe

# 봇 재시작
Start-ScheduledTask -TaskName "HoyoBot_AutoStart"
```

### 환경 변수 오류
`run.ps1` 파일에 Discord 토큰과 Gemini API 키가 올바르게 설정되어 있는지 확인하세요.

## 🎯 주요 파일 설명

| 파일 | 설명 |
|------|------|
| `start_bot_background.vbs` | 백그라운드 실행용 VBS 스크립트 |
| `install_service.ps1` | 작업 스케줄러 등록 (관리자 권한 필요) |
| `uninstall_service.ps1` | 작업 스케줄러 제거 (관리자 권한 필요) |
| `control_bot.ps1` | 봇 제어 패널 (시작/중지/로그) |
| `run.ps1` | 수동 실행용 (터미널에서 로그 확인) |

## 💡 팁

- **재부팅 후 자동 시작**: `install_service.ps1` 실행 후 자동으로 설정됨
- **백그라운드 실행 확인**: 작업 관리자 → 세부 정보 탭 → `python.exe` 프로세스 확인
- **로그 모니터링**: `control_bot.ps1`의 실시간 모니터링 기능 사용
- **서비스 제거**: 더 이상 자동 시작이 필요 없으면 `uninstall_service.ps1` 실행

## ⚠️ 주의사항

1. **환경 변수 보안**: `run.ps1`에 API 키가 저장되므로 파일 공유 시 주의
2. **작업 스케줄러**: 설치/제거 시 반드시 관리자 권한 필요
3. **로그 크기**: 로그 파일이 계속 커지므로 주기적으로 정리 권장
4. **프로세스 충돌**: 수동 실행(`run.ps1`)과 자동 실행이 동시에 되지 않도록 주의

## 🆘 문제 해결

문제가 발생하면 다음 순서로 확인하세요:
1. `control_bot.ps1` → "7. 작업 스케줄러 상태 확인"
2. `bot_error.log` 파일 확인
3. 수동 실행 테스트: `.\run.ps1`
4. 모든 프로세스 종료 후 재시작




